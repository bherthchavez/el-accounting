<%- include('layout/header') %>

  <div class="page-wrapper">
    <div class="container-xl">
      <!-- Page title -->
      <div class="page-header d-print-none">
        <div class="row g-2 align-items-center">
          <div class="col">

            <h2 class="page-title">
              Pay Supplier Bill
            </h2>
          </div>
        </div>
      </div>
    </div>

    <form action="/pay-supplier" method="post" id="add-form" enctype="multipart/form-data">

    <div class="page-body">
      <div class="container-xl">
        <div class="row row-cards">
          <div class="col-12">
            <div class="card">
              
                <div class="card-header hd-right">
                  <div class="row align-items-center">
                    <small class="text-muted"> </i>Supplier Name</small>
                    <h2 class="m-0 mt-3 text-warning"></i> <%= supplierName %> </h2>
                    <p class=" text-muted"> <%= aName %> </p>
                  </div>
                </div>
                    <div class="card-body">
                      <div class="row mt-lg-2">
                        <div class="col-lg-6">
                          <div class="row">
                          <div class="col-6"> 
                            <div class="mb-3">
                              <input type="text" name="supplierID" value="<%= accountID %>" hidden>
                              <input type="text" name="supplierName" value="<%=supplierName%>" hidden>
                              <input type="text" id="numOfAcc" name="numOfItem" value="0" hidden>
                              <input type="text" id="numOfBill" name="numOfBill" value="0" hidden>
      
                              <div class="form-label">Payment Number</div>
                                 <input type="text" name="pavNo" class="form-control" value="<%=pavno%>" readonly>
                            </div>
                          </div>

                          <div class="col-6"> 
                            <div class="mb-3">
                              <div class="form-label">Payment From</div>
                                <select name="paymentFrom" class="form-select" required>
                                  <option value=""></option>
                                  <%  bankAccounts.forEach(function(account) { %>
                                  <option value="<%=account._id%>"><%=account.bank_name%></option>
                                  <%  }) %>

                                </select>
                            </div>
                          </div>
                        </div>
                          
                          <div class="row">
                            <div class="col-6">
                              <div class="mb-3">
                                  <div class="form-label">Payment Date</div>
                                <!-- <input type="date" name="billDate" class="form-control" required> -->
                                <div class="input-icon mb-2">
                                  <input name="billDate" class="form-control " placeholder="Select payment date" id="datepicker-icon" required/>
                                  <span class="input-icon-addon">
                                    <i class="ti ti-calendar"></i>
                                  </span>
                                </div>
                              
                              </div>
                            </div>
                            <div class="col-6">
                              <div class="mb-3">
                                <div class="form-label">Payment Mode</div>
                                <select name="paymentMode" class="form-select paymentMode"  onchange="changePayment(this)">
                                  <option value=""></option>
                                  <option value="Cash">Cash</option>
                                  <option value="Cheque">Cheque</option>
                                  <option value="Bank Transfer">Bank Transfer</option>
                                </select>
                              
                              </div>
                            </div>
                            <div class="col-6">
                              <div class="mb-3"> 
                                <div class="mb-3">
                                <div class="form-label">Upload Documents</div>
                                <input type="file" name="documents" class="form-control"  accept="image/*,.pdf" required>
                              </div>
                              </div>
                            </div>
      
                            <div class="col-6">
                              <div class="mb-3">
                               
          
                                <div class="mb-3">
                                  <label class="form-label">Payment Amount</label>
                                  <div class="input-group mb-2">
                                    <span class="input-group-text fs-5">
                                      QAR
                                    </span>
                                    <input type="text" id="paymentAmount" class="form-control text-danger fw-bold "  name="totalPayment"  placeholder="0.00" readonly required>
                                  </div>
                                 
                                
                                </div>
      
                              </div>
                            </div>
                          </div>
                        </div>
      
                        <div class="col-lg-6">
                         
                          <div class="mb-3">
                            <label class="form-label">Description</label>
                            <textarea class="form-control" name="description" rows="9" required></textarea>
                          </div>
                         </div>

                        
                      
                         <div class="row">

                          <div class="col-12  mt-lg-4 totalInfo">
                            <div class="mb-3 fs-4">
                              <small class="text-danger paymentAmountInfo"></small>
                            </div>
                                  <div class="card">
                                    <ul class="nav nav-tabs" data-bs-toggle="tabs">
                                     
                                      <li id="itemTotal" class="nav-item">
                                        <a id="tabsBill" href="#tabs-bill-17" class="nav-link active" data-bs-toggle="tab">Bill 
                                          <label class="ms-2 billTotal text-danger">0.0</label>
                                        </a>
                                      </li>
                                     

                                    
                                    </ul>

                                    <div class="card-body">
                                      <div class="tab-content">
                                        <div class="tab-pane fade active show" id="tabs-bill-17">

                                          <div class="table-responsive">
                                            <div class="mb-3">
                                            <small> Select the Bills below against which to pay the amount. </small>
                                          </div>
                                            <table class="table card-table table-vcenter text-nowrap datatable">
                                              <thead>
                                                <tr>
                                                  <th class="w-0">
                                                  </th>
                                                  <th class="w-5">Bill No</th>
                                                  <th class="w-5">Bill Date</th>
                                                  <th class="w-5">Description</th>
                                                  <th class="w-5">Created By</th>
                                                  <th class="w-5"> Bill Amount</th>
                                                  <th  class="text-end w-5"> Amount to Pay</th>
                                                </tr>
                                              </thead>
                                              <tbody>
                                         <%  suppBills.forEach(function(bill){ %>
                                                <tr>
                                                 <td>
                                                  <input class="form-check-input m-0 align-middle selectBill" name="selectedbillNo" type="checkbox" aria-label="Select bill" value="<%= bill.bill_number %>">
                                                  <input type="text" name="selectedBillAmount" class="form-control-rounded selectedBillAmount" value="<%= bill.total_payment %>" hidden>

                                                </td>
                                                  <td>
                                                    <%=bill.bill_number%>
                                                  </td>
                                                  <td>
                                                    <%=(new Date(bill.bill_date).toLocaleDateString("en-US", {year: 'numeric', month: 'short', day: 'numeric' }))%>

                                                  </td>
                                                  <td>
                                                 
                                                    <%=bill.description.substring(0, 20)%>
                                                    <a class="cursor-pointer" data-bs-toggle="tooltip" data-bs-placement="right" data-bs-custom-class="custom-tooltip" data-bs-title="<%=bill.description%>">
                                                    ...
                                                    </a>
                                                  </td>
                                                  <td>
                                                    <%=bill.created_by%>
                                                  </td>
                                                  <td>
                                                  
                                                    <div class="currency-formated">QAR</div> 
                                                    <div class="number-details text-danger bill"> <%= parseFloat(bill.total_payment).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,') %></div>
                                                   
                                                  </td>
                                                  <td>
                                                    <input type="text" name="billAmount" class="amountPay qty form-control form-control-rounded text-end me-5 "placeholder="0" readonly>
      
                                                  </td>
                                          
                                                </tr>
                                                <%  }) %>
                                              </tbody>
                                            </table>
                                          </div>                                        
                                        </div>
                                      
                                        <div class="tab-pane fade" id="tabs-cheque-17">
                                        
                                          <div id="cheque-17-details" class="table-responsive">
                                            <table id="tableAddAcc" class="table table-vcenter table-nowrap" >
                                              <thead>
                                                <tr>
                                                  <th class="w-1"></th>
                                                  <th >Cheque Number</th>
                                                  <th  >Beneficiary Name</th>
                                                  <th  >Cheque Date</th>
                                                  <th  >Cheque Status</th>
                                                  <th  class="text-end">	 Amount</th>
                                                </tr>
                                              </thead> 
                                                    <tbody>
                                                     

                                                    </tbody> 
                                              </table> 
                                            </div>
                                             
                                          <div class="row align-items-center mt-3">
                                              <div class="col-lg-6">
                                                <button id="insertRowAcc" class="btn btn-secondary btn-pill btn--small"><i class="ti ti-plus"></i> Add Cheques </button> 
                                            </div> 
                                            <div class="col-lg-6">
                                              <div class="user-option me-3">
                                              <div class="currency-formated-a">Total Cheque Amount (QAR)</div>
                                              <div class="number-details ms-3 text-danger totalAmount fw-bold">0.00</div>
                                              </div>
                                              </div>
                                          </div>


                                        </div>

                                        <div class="tab-pane fade" id="tabs-cash-17">
                                        
                                          <div id="cash-17-details" class="table-responsive">
                                            <table id="tableAddcash" class="table table-vcenter table-nowrap" >
                                              <thead>
                                                <tr>
                                                  <th class="w-1"></th>
                                                  <th >Cheque Number</th>
                                                  <th  >Beneficiary Name</th>
                                                  <th >Cheque Date</th>
                                                  <th  >Cheque Status</th>
                                                  <th  class="text-end">	 Amount</th>
                                                </tr>
                                              </thead> 
                                                    <tbody>
                                                     

                                                    </tbody> 
                                              </table> 
                                            </div>
                                             
                                          <div class="row align-items-center mt-3">
                                            <div class="col-lg-6">
                                              <button id="insertRowCash" class="btn btn-secondary btn-pill btn--small"><i class="ti ti-plus"></i> Add cash </button> 
                                          </div> 
                                          <div class="col-lg-6">
                                            <div class="user-option me-3">
                                            <div class="currency-formated-a">Total Cash Amount (QAR)</div>
                                            <div class="number-details ms-3 text-danger totalAmount fw-bold">0.00</div>
                                          </div>
                                          </div>
                                        </div>


                                        </div>

                                        <div class="tab-pane fade" id="tabs-bankTransfer-17">
                                        
                                        
                                            <div  id="bankTransfer-17-details" >
                                             
                                                <div class="row">
                                                
                                                  
                                                  <div class="col-md-2">
                                                    <div class="card-title">Beneficiary Details</div>
                                                 
                                                      
                                                      <div class="mb-2 fs-5">
                                                        Name: <strong>Al Nakeel</strong>
                                                      </div>

                                                      <div class="mb-2 fs-5">
                                                        Address: <strong>Doha City</strong>
                                                      </div>

                                                      <div class="mb-2 fs-5">
                                                        Bank Name: <strong>QNB</strong>
                                                       </div>
                                                      <div class="mb-2 fs-5">
                                                       Iban No: <strong>32CVE234</strong>
                                                      </div>
  
                                                      <div class="mb-2 fs-5">
                                                        Swift Code: <strong>CW4213DWE</strong>
                                                      </div>
                                                </div>
                                                
                                                  <div class="col-md-3">

                                                    <div class="form-group mb-2 btn--smal ">
                                                      <label class="form-label"> Transfer Charge</label>
                                                      <select name="transferCharge" class="form-select" >
                                                        <option value="Debit to my Account">Debit to my Account</option>
                                                        <option value="Debit to beneficiary Account">Debit to beneficiary Account</option>
                                                      </select>

                                                    </div>

                                                    <div class="form-group mb-2 btn--smal">
                                                      <label class="form-label"> Transfer Purpose</label>
                                                   
                                                      <select name="transferPurpose" class="form-select" >
                                                        
                                                        <%  purposeItems.forEach(function(item) { %>
                                                        <option value="<%=item.purpose%> "><%=item.purpose%> </option>
                                                        <%  }) %>
                      
                                                      </select>

                                                    </div>


                                                  
                                                  
                                                
                                                  </div>
                                                  <div class="col-md-4">
                                                  
                                                   
                                                      <div class=" form-group mb-2  ">
                                                        <label class="form-label">Select Currency</label>
                                                        <div class="input-group mb-3">
                                                          <span>
                                                            <select name="curreny" class="form-select" >
                                                              <option value="QAR">QAR</option>
                                                              <option value="USD">USD</option>
                                                              <option value="EUR">EUR</option>
                                                            </select>
                                                          </span>
                                                          <input type="text" name="bankAmount" class="form-control convert  fw-bold text-danger" placeholder="Enter Amount"/>
                                                          <!-- <a class="btn btn-primary btn--small" onclick="toWords($('.convert').val())">Convert to Words</a> -->
                                                        </div>
                                                      </div>
                                                      <div class=" form-group mb-3 fs-6">
                                                        <textarea class="form-control 2word" name="amountInWords" rows="2" readonly></textarea>
                                                      </div>
                                                    
                                                    
                                                
                                                  </div>
                                                  <div class="col-md-3">
                                                  
                                                   
                                                    <div class=" form-group mb-2  ">
                                                      <label class="form-label text-end">Bank Transfer Amount</label>
                                                      <div class="input-group mb-2">
                                                        
                                                        <input type="text" id="bankAmount" class="form-control pe-3 text-danger fw-bold text-end bankAmount"  name="bankTransferAmount"  placeholder="0.00">
                                                        <span class="input-group-text fs-5">
                                                          QAR
                                                        </span>
                                                      </div>
                                                      <div class="text-end bankInfo">
                                                     
                                                    </div>
                                                    </div>
                                                   
                                                  
                                                  
                                              
                                                </div>
                                                  
                                                </div>
                                            </div>
                                          
                                          
                                   


                                        </div>


                                      </div>
                                    </div>
                                  </div>
                                </div>
                          
                        
                  </div>
                </div>
              </div>
                  <div class="card-footer">
                    <div class="row align-items-center">
                      <div class="col"></div>
                      <div class="col-auto">
                        <a href="/supplier-accounts" class="btn cancelBill">
                          Cancel
                        </a>
                        <button type="submit"  class="btn btn-primary ms-3 bankSubmit" disabled> Save</button>
    
                      </div>
                    </div>
                  </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    </form> 

    <script src="../dist/libs/nouislider/dist/nouislider.min.js" defer></script>
    <script src="../dist/libs/litepicker/dist/litepicker.js" defer></script>
    <script src="../dist/libs/tom-select/dist/js/tom-select.base.min.js" defer></script>
    <script>
    // @formatter:off
    document.addEventListener("DOMContentLoaded", function () {
      window.Litepicker && (new Litepicker({
        element: document.getElementById('datepicker-icon'),
        buttonText: {
          previousMonth: `<!-- Download SVG icon from http://tabler-icons.io/i/chevron-left -->
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="15 6 9 12 15 18" /></svg>`,
          nextMonth: `<!-- Download SVG icon from http://tabler-icons.io/i/chevron-right -->
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="9 6 15 12 9 18" /></svg>`,
        },
      }));
    });
    // @formatter:on
  </script>

    <script>
      $(document).ready(function(){
        $(".cancelBill").on("click", function(){
          $(".cancelBill").prepend('<span class="spinner-border spinner-border-sm me-2" role="status"></span> ');
        })

        // $(".bankSubmit").on("click", function(){
        //   $(".bankSubmit").prepend('<span class="spinner-border spinner-border-sm me-2" role="status"></span> ');
        // })

        $('#datepicker-icon').val(new Date().toISOString().split('T')[0])
      });
    </script>

    
     <script>
      $(function () {
        var count = 0;
    
        $("#insertRowAcc").on("click",  event => {
    
          event.preventDefault();
         
            var cols = "";
            cols += '<tr class="tableChequeRow"><td><button class="btn bg-red-lt rounded-pill m-0"  id ="deleteRow"><i class="ti ti-trash"></i> </button></td>';
          
            cols += '  <td><input type="text" name="chequeNo" class="form-control" placeholder="Cheque No" required></td>';
            
            cols += '  <td><input type="text" name="beneficiaryName" class="form-control" value="<%=beneficiaryName%>"readonly></td>';


            cols +=  ' <td> <input type="date" name="chequeDate" class="form-control" required></td>';
              
         

            cols +=  '<td><select name="chequeStatus" class="form-select" required><option value="PDC">PDC</option><option value="Cleared">Cleared</option></select></td>';
            cols +=  '<td ><input type="text" name="chequeAmount" class="chequeAmount form-control form-control-rounded text-end pe-3" placeholder="0.0" required> </td></tr>';

         
          $('#tableAddAcc').append(cols);
              count++;
              $("#numOfAcc").val(count)
           
        });
    
          $("#tableAddAcc").on("click", "#deleteRow", function (event) {
            $(this).closest("tr").remove();
             count --;
             $("#numOfAcc").val(count)
            
        });

   

    
      });
    </script>
     <script>
      $(function () {
        var count = 0;
    
        $("#insertRowCash").on("click",  event => {
    
          event.preventDefault();
         
            var cols = "";
            cols += '<tr class="tableChequeRow"><td><button class="btn bg-red-lt rounded-pill m-0"  id ="deleteRow"><i class="ti ti-trash"></i> </button></td>';
          
            cols += '  <td><input type="text" name="chequeNo" class="form-control" placeholder="Cheque No" required></td>';
            
            cols += '  <td><input type="text" name="beneficiaryName" class="form-control" value="Bearer"readonly></td>';


            cols +=  ' <td> <input type="date" name="chequeDate" class="form-control" required></td>';
              
         

            cols +=  '<td><select name="chequeStatus" class="form-select" required><option value="PDC">PDC</option><option value="Cleared">Cleared</option></select></td>';
            cols +=  '<td ><input type="text" name="chequeAmount" class="chequeAmount form-control form-control-rounded text-end pe-3" placeholder="0.0" required> </td></tr>';

         
          $('#tableAddcash').append(cols);
              count++;
              $("#numOfAcc").val(count)
        });
    
          $("#tableAddcash").on("click", "#deleteRow", function (event) {
            $(this).closest("tr").remove();
             count --;
             $("#numOfAcc").val(count)
        });
    
      });
    </script>
    


    <script>
     $(document).ready(function(){ 

      $('#selectAll').click(function(e){     
       
        $(this).closest('table').find('td input:checkbox').prop('checked', this.checked);
       
     });

   
      $(".selectBill").click(function(e){ 
        let billNo =  $("#numOfBill").val()

        if ($(this).is(":checked")){
          $(this).closest("tr").find("td input.amountPay").val($(this).closest("tr").find("td input.selectedBillAmount").val());
          billNo ++;
        }else{
          $(this).closest("tr").find("td input.amountPay").val("");
          billNo --;
        }

        var sum =0;
        $("input.amountPay").each(function() {
            sum += + ($(this).val().split(',').join(''));
          });
        
          $('#paymentAmount').val((sum).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'));
          $(".billTotal").text((sum).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'))

          $("#numOfBill").val(billNo);
          checkPaymentMode();
        

      });



      $("#tableAddAcc").on('input', '.chequeAmount', function () {
        var calculated_total_sum = 0;
      
        $("#tableAddAcc .chequeAmount").each(function () {
            var get_textbox_value = + $(this).val().split(',').join('');
            if ($.isNumeric(get_textbox_value)) {
                calculated_total_sum += get_textbox_value;
                }                  
              });
                $("div .totalAmount").html((calculated_total_sum).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'));
                chanegPaymentAmmount();
                checkPaymentMode();
        });


        $("#tableAddAcc").on('click','#deleteRow', function () {
          var calculated_total_sum = 0;

          $("#tableAddAcc .chequeAmount").each(function () {
            var get_textbox_value = + $(this).val().split(',').join('');
            if ($.isNumeric(get_textbox_value)) {
                calculated_total_sum += get_textbox_value;
                }                  
              });
              $("div .totalAmount").html((calculated_total_sum).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'));
                chanegPaymentAmmount();
                checkPaymentMode();
        });


        
      $("#tableAddcash").on('input', '.chequeAmount', function () {
        var calculated_total_sum = 0;
      
        $("#tableAddcash .chequeAmount").each(function () {
            var get_textbox_value = + $(this).val().split(',').join('');
            if ($.isNumeric(get_textbox_value)) {
                calculated_total_sum += get_textbox_value;
                }                  
              });
                $("div .totalAmount").html((calculated_total_sum).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'));
                chanegPaymentAmmount();
                checkPaymentMode();
        });

        $("#tableAddcash").on('click','#deleteRow', function () {
          var calculated_total_sum = 0;

          $("#tableAddcash .chequeAmount").each(function () {
            var get_textbox_value = + $(this).val().split(',').join('');
            if ($.isNumeric(get_textbox_value)) {
                calculated_total_sum += get_textbox_value;
                }                  
              });
              $("div .totalAmount").html((calculated_total_sum).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,'));
                chanegPaymentAmmount();
                checkPaymentMode();
        });

     
        $("#bankAmount").keyup(()=>{
       
          var bankAmount = + ($("#bankAmount").val().split(',').join(''))
       
          $(".bankTotal").text((bankAmount).toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,')); 
          
          var bankTotal = $('.bankTotal').text()
          var billTotal = $('.billTotal').text()
          if (bankTotal === billTotal){
            $('.paymentAmountInfo').text(""); 
            $('.bankSubmit').prop("disabled", false);
          }else{
            $('.paymentAmountInfo').text("The bank transfer should balance with the bill."); 
            $('.bankSubmit').prop("disabled", true);
          }
        
        })

        
        function checkPaymentMode(){
          if($('.paymentMode').val() === "Cash"){

              var cashTotal = $('.cashTotal').text()
              var billTotal = $('.billTotal').text()

                if (cashTotal === billTotal){
                  $('.paymentAmountInfo').text(""); 
                  $('.bankSubmit').prop("disabled", false);
                }else{
                  $('.paymentAmountInfo').text("The cash should balance with the bill."); 
                  $('.bankSubmit').prop("disabled", true);
                }
                
              }else if($('.paymentMode').val() === "Cheque"){

              var chequeTotal = $('.chequeTotal').text()
              var billTotal = $('.billTotal').text()

                if (chequeTotal === billTotal){
                  $('.paymentAmountInfo').text(""); 
                  $('.bankSubmit').prop("disabled", false);
                }else{
                  $('.paymentAmountInfo').text("The cheque should balance with the bill."); 
                  $('.bankSubmit').prop("disabled", true);
                }

              }else if($('.paymentMode').val() === "Bank Transfer"){

              var bankTotal = $('.bankTotal').text()
              var billTotal = $('.billTotal').text()

                if (bankTotal === billTotal){
                  $('.paymentAmountInfo').text(""); 
                  $('.bankSubmit').prop("disabled", false);
                }else{
                  $('.paymentAmountInfo').text("The bank transfer should balance with the bill."); 
                  $('.bankSubmit').prop("disabled", true);
                }

              }else{
              $('.paymentAmountInfo').text("Please Select Payment Mode."); 
                  $('.bankSubmit').prop("disabled", true);
              }

        }
       


        function chanegPaymentAmmount(){
          $(".chequeTotal").text($('div .totalAmount').html()); 
          $(".cashTotal").text($('div .totalAmount').html()); 

          
        }

    
    
    });

        function changePayment(selectObject) {
          $("#bankAmount").val("");
          $("#numOfAcc").val(0)
          $('div .totalAmount').html("0.00")
            var value = selectObject.value;  
           
            if(value === "Cash"){  

              $('.paymentAmountInfo').text("The cash should balance with the bill."); 

              $("#itemTotal").after('<li id="paymentCash" class="nav-item"><a href="#tabs-cash-17" class="nav-link active" data-bs-toggle="tab">Cash<label class="ms-2 cashTotal text-danger"> 0.0</label></a></li>');
              $("#tabs-cash-17").addClass("active show");
              $("#tabsBill").removeClass("active");
              $("#tabs-bill-17").removeClass("active show");


              $('.tableChequeRow').remove();
              $("#paymentCheque").remove();
              $('.chequeInfolbl').remove();
              $("#tabs-cheque-17").removeClass("active show");

              $("#tabs-bankTransfer-17").removeClass("active show");
              $("#tabsBankTransfer").remove();
          
          
           
            }else if(value === "Cheque"){
              $('.paymentAmountInfo').text("The cheque should balance with the bill."); 
             
              $("#itemTotal").after('<li id="paymentCheque" class="nav-item"><a href="#tabs-cheque-17" class="nav-link active" data-bs-toggle="tab">Cheques<label class="ms-2 chequeTotal text-danger"> 0.0</label></a></li>');
              $("#tabsBill").removeClass("active");
              $("#tabs-bill-17").removeClass("active show");
              $("#tabs-cheque-17").addClass("active show");
                    
              $('.tableChequeRow').remove();
              $('.cashInfolbl').remove();
              $("#paymentCash").remove();
              $("#tabs-cash-17").removeClass("active show");

              $("#tabs-bankTransfer-17").removeClass("active show");
              $("#tabsBankTransfer").remove();


            }else if(value === "Bank Transfer"){
              $('.paymentAmountInfo').text("The bank transfer should balance with the bill."); 
              
              $("#itemTotal").after('<li id="tabsBankTransfer" class="nav-item"><a href="#tabs-bankTransfer-17" class="nav-link active" data-bs-toggle="tab">Bank Transfer <label class="ms-2 bankTotal text-danger"> 0.0</label></a></li>');
              $("#tabs-bankTransfer-17").addClass("active show");
              $("#tabsBill").removeClass("active");
              $("#tabs-bill-17").removeClass("active show");

              $('.tableChequeRow').remove();
              $('.cashInfolbl').remove();
              $("#paymentCash").remove();
              $("#tabs-cash-17").removeClass("active show");

              $('.tableChequeRow').remove();
              $("#paymentCheque").remove();
              $('.chequeInfolbl').remove();
              $("#tabs-cheque-17").removeClass("active show");

            }else{
              $('.paymentAmountInfo').text("Please Select Payment Mode."); 
              
              $("#paymentCheque").remove();
              $("#tabsBill").addClass("active");
              $("#tabs-bill-17").addClass("active show");
              $("#tabs-cheque-17").removeClass("active show");
              $("#tabs-bankTransfer-17").removeClass("active show");
              $("#tabsBankTransfer").remove();

             
              $("#paymentCash").remove();
              $("#tabs-cash-17").removeClass("active show");

              $('.tableChequeRow').remove();
             
            }

            
            if($('.paymentMode').val() == "Cash"){

              var cashTotal = $('.cashTotal').text()
              var billTotal = $('.billTotal').text()

                if (cashTotal === billTotal){
                  $('.paymentAmountInfo').text(""); 
                  $('.bankSubmit').prop("disabled", false);
               
                }else if(billTotal=== '0.0'){

                    $('.paymentAmountInfo').text("Please Select Bill."); 
                    $('.bankSubmit').prop("disabled", true);

                }else{
                  $('.paymentAmountInfo').text("The cash should balance with the bill."); 
                  $('.bankSubmit').prop("disabled", true);
                }
                
              }else if($('.paymentMode').val() == "Cheque"){

              var chequeTotal = $('.chequeTotal').text()
              var billTotal = $('.billTotal').text()

                if (chequeTotal === billTotal){
                  $('.paymentAmountInfo').text(""); 
                  $('.bankSubmit').prop("disabled", false);

                }else if(billTotal=== '0.0'){

                    $('.paymentAmountInfo').text("Please Select Bill."); 
                    $('.bankSubmit').prop("disabled", true);
                    
                }else{
                  $('.paymentAmountInfo').text("The cheque should balance with the bill."); 
                  $('.bankSubmit').prop("disabled", true);
                }

              }else if($('.paymentMode').val() == "Bank Transfer"){

                var bankTotal = $('.bankTotal').text()
                var billTotal = $('.billTotal').text()

                if (bankTotal === billTotal){
                  $('.paymentAmountInfo').text(""); 
                  $('.bankSubmit').prop("disabled", false);
                
                }else if(billTotal=== '0.0'){

                    $('.paymentAmountInfo').text("Please Select Bill."); 
                    $('.bankSubmit').prop("disabled", true);
                    
                }else{
                  $('.paymentAmountInfo').text("The bank transfer should balance with the bill."); 
                  $('.bankSubmit').prop("disabled", true);
                }
                
                
              }else{
                  $('.paymentAmountInfo').text("Please Select Payment Mode."); 
                  $('.bankSubmit').prop("disabled", true);
              }
        }
    </script>


<script>
  
  $('.convert').keyup(()=>{
    
    var x = $('.convert').val();
     
      x = (x).split(',').join('');
      x = parseFloat(x)
      x = "" + x
      toWords(x);
   
  });



function toWords(s) {

  var th = ['', 'Thousand', 'Million', 'Billion', 'Trillion'];

var dg = ['Zero', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
var tn = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
var tw = ['Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];


    s = s.toString();
    s = s.replace(/[\, ]/g, '');
    if (s != parseFloat(s)) return 'not a number';
    var x = s.indexOf('.');
	var fulllength=s.length;
	
    if (x == -1) x = s.length;
    if (x > 15) return 'too big';
	var startpos=fulllength-(fulllength-x-1);
    var n = s.split('');
	
    var str = '';
    var str1 = ''; //i added another word called cent
    var sk = 0;
    for (var i = 0; i < x; i++) {
        if ((x - i) % 3 == 2) {
            if (n[i] == '1') {
                str += tn[Number(n[i + 1])] + ' ';
                i++;
                sk = 1;
            } else if (n[i] != 0) {
                str += tw[n[i] - 2] + ' ';

                sk = 1;
            }
        } else if (n[i] != 0) {
            str += dg[n[i]] + ' ';
            if ((x - i) % 3 == 0) str += 'Hundred ';
            sk = 1;
        }
        if ((x - i) % 3 == 1) {
            if (sk) str += th[(x - i - 1) / 3] + ' ';
            sk = 0;
        }
    }
    if (x != s.length) {
        
        str += 'and '; //i change the word point to and 
        // str1 += 'Cents '; //i added another word called cent
        //for (var i = x + 1; i < y; i++) str += dg[n[i]] + ' ' ;
		 var j=startpos;
		
		 for (var i = j; i < fulllength; i++) {
		 
        if ((fulllength - i) % 3 == 2) {
            if (n[i] == '1') {
                str += tn[Number(n[i + 1])] + ' ';
                i++;
                sk = 1;
            } else if (n[i] != 0) {
                str += tw[n[i] - 2] + ' ';
				
                sk = 1;
            }
        } else if (n[i] != 0) {
		
            str += dg[n[i]] + ' ';
            if ((fulllength - i) % 3 == 0) str += 'Hundred ';
            sk = 1;
        }
        if ((fulllength - i) % 3 == 1) {
		
            if (sk) str += th[(fulllength - i - 1) / 3] + ' ';
            sk = 0;
        }
    }
    }
	var result=str.replace(/\s+/g, ' ') + "Only";
    //return str.replace(/\s+/g, ' ');
   
      $('.2word').text(result);
    return result; //i added the word cent to the last part of the return value to get desired output
    
	
	
}


      
</script>

<%- include('layout/footer') %>